<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Maximum Likelihood Estimation · InformationGeometry</title><meta name="title" content="Maximum Likelihood Estimation · InformationGeometry"/><meta property="og:title" content="Maximum Likelihood Estimation · InformationGeometry"/><meta property="twitter:title" content="Maximum Likelihood Estimation · InformationGeometry"/><meta name="description" content="Documentation for InformationGeometry."/><meta property="og:description" content="Documentation for InformationGeometry."/><meta property="twitter:description" content="Documentation for InformationGeometry."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="InformationGeometry logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">InformationGeometry</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Getting Started</a></li><li><a class="tocitem" href="../basics/">Basics of Information Geometry</a></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="../datamodels/">Providing Data and Models</a></li><li class="is-active"><a class="tocitem" href>Maximum Likelihood Estimation</a></li><li><a class="tocitem" href="../confidence-regions/">Confidence Regions</a></li><li><a class="tocitem" href="../parameter-profiles/">Profile Likelihoods</a></li><li><a class="tocitem" href="../transformations/">Model Transformations</a></li><li><a class="tocitem" href="../plotting/">Useful Diagnostic Plots</a></li><li><a class="tocitem" href="../parallelization/">Parallelization</a></li><li><a class="tocitem" href="../exporting/">Exporting</a></li></ul></li><li><span class="tocitem">Advanced Examples</span><ul><li><a class="tocitem" href="../ODEmodels/">ODE-based Models</a></li><li><a class="tocitem" href="../AdvancedData/">Advanced Dataset Types</a></li><li><a class="tocitem" href="../ConditionGrids/">Linking Multiple Models and Datasets</a></li></ul></li><li><span class="tocitem">Package Extensions</span><ul><li><a class="tocitem" href="../PEtabExt/">PEtab.jl</a></li></ul></li><li><a class="tocitem" href="../methodlist/">List of useful methods</a></li><li><a class="tocitem" href="../todo/">Contributing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorial</a></li><li class="is-active"><a href>Maximum Likelihood Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Maximum Likelihood Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/RafaelArutjunjan/InformationGeometry.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/RafaelArutjunjan/InformationGeometry.jl/blob/master/docs/src/optimization.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h3 id="Maximum-Likelihood-Estimation"><a class="docs-heading-anchor" href="#Maximum-Likelihood-Estimation">Maximum Likelihood Estimation</a><a id="Maximum-Likelihood-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Maximum-Likelihood-Estimation" title="Permalink"></a></h3><p>Unless the kwarg <code>SkipOptim=true</code> is passed to the <code>DataModel</code> constructor, it automatically tries to optimize the model parameters in an attempt to find the MLE. If no initial guess for the values parameters is provided, the constructor will try to infer the correct number of parameters and make a random initial guess. However, more control can be exerted over the optimization process by choosing an appropriate optimization method and corresponding options. These options may either be be passed to the <code>DataModel</code> constructor, or the optimization method <code>InformationGeometry.minimize</code> may be invoked explicitly after the <code>DataModel</code> was constructed with either unsuccessful optimization or skipping the automatic initial optimization altogether.</p><p>Most importantly, <code>InformationGeometry.minimize</code> is compatible with the <a href="https://github.com/SciML/Optimization.jl"><strong>Optimization.jl</strong></a> ecosystem of optimizer methods via the <code>meth</code> keyword. Best support is available for optimizers from the <a href="https://github.com/JuliaNLSolvers/Optim.jl"><strong>Optim.jl</strong></a> via a custom wrapper. Choosing <code>meth=nothing</code> also allows for using a Levenberg-Marquardt method from the <a href="https://github.com/JuliaNLSolvers/LsqFit.jl"><strong>LsqFit.jl</strong></a> optimizer, which is however only possible if data with fixed Gaussian uncertainties and no priors are used.</p><pre><code class="language-julia hljs">DM = DataModel(DataSet(1:3, [4,5,6.5], [0.5,0.45,0.6]), (x,p)-&gt;(p[1]+p[2])*x + exp(p[1]-p[2]), [1.3, 0.2]; SkipOptim=true)
plot(DM; Confnum=0)</code></pre><img src="ecdeb222.svg" alt="Example block output"/><p>The optimization can then be performed with:</p><pre><code class="language-julia hljs">using Optim
mle = InformationGeometry.minimize(DM; meth=NewtonTrustRegion(), tol=1e-12, maxtime=60.0, Domain=HyperCube(zeros(2), 10ones(2)), verbose=true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
 1.1084748685240409
 0.12215893451975594</code></pre><p>The full solution object is returned if the keyword argument <code>Full=true</code> is additionally provided.</p><p>Alternatively, one might use <a href="https://docs.sciml.ai/Optimization">optimizers</a> from the <a href="https://github.com/SciML/Optimization.jl"><strong>Optimization.jl</strong></a> ecosystem e.g. via</p><pre><code class="language-julia hljs">using Optimization, OptimizationOptimisers
mle = InformationGeometry.minimize(DM, rand(2); meth=Optimisers.AdamW())</code></pre><p>or</p><pre><code class="language-julia hljs">using Optimization, OptimizationNLopt
mle = InformationGeometry.minimize(DM, rand(2); meth=NLopt.GN_DIRECT())</code></pre><p>Finally, the newly found optimum can be visually inspected with</p><pre><code class="language-julia hljs">plot(DM, mle)</code></pre><img src="535f10a7.svg" alt="Example block output"/><p>and added to the original unoptimized <code>DataModel</code> object via</p><pre><code class="language-julia hljs">DM = DataModel(Data(DM), Predictor(DM), mle; SkipOptim=true)</code></pre><h3 id="Multistart-Optimization"><a class="docs-heading-anchor" href="#Multistart-Optimization">Multistart Optimization</a><a id="Multistart-Optimization-1"></a><a class="docs-heading-anchor-permalink" href="#Multistart-Optimization" title="Permalink"></a></h3><p>When a reasonable estimate for the initial parameter configuration is not available and optimizations starting from the approximate center of the parameter domain do not converge to a suitable optimum, a systematic search of the parameter space is needed. This can be achieved with the <code>MultistartFit</code> method, which will sample the parameter space <span>$\mathcal{M}$</span> either according to a given probability distribution (e.g. uniform / normal) on <span>$\mathcal{M}$</span> or by drawing the parameter values from a <a href="https://en.wikipedia.org/wiki/Low-discrepancy_sequence">low-discrepancy sequence</a> such as the <a href="https://github.com/JuliaMath/Sobol.jl">Sobol</a> sequence. Compared with uniformly drawn values, values drawn from low-discrepancy sequences achieve a more even and &quot;equidistant&quot; coverage, thereby slightly increasing the chances of discovering a larger number of distinct local optima overall.</p><p>Just like <code>InformationGeometry.minimize</code>, the <code>MultistartFit</code> method is also compatible with the <a href="https://github.com/SciML/Optimization.jl"><strong>Optimization.jl</strong></a> ecosystem of optimizer methods via the <code>meth</code> keyword.</p><pre><code class="language-julia hljs">using Optim
R = MultistartFit(DM; N=200, maxval=500, meth=LBFGS())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr38_2" style="color:#56b6c2">MultistartResults</span> with 200/244 successful starts
Median number of iterations: 1
121/200 (60.0 %) convergent fits had same final objective value: -6.5874</code></pre><p>The most relevant keywords are:</p><ul><li><code>MultistartDomain::HyperCube</code> for defining the domain from which the initial guesses are drawn</li><li><code>N::Int</code> for choosing the number of starts</li><li><code>meth</code> for choosing the optimizer</li><li><code>resampling=false</code> disables the drawing of new guesses when the objective function cannot be evaluated in some regions of the parameter space</li><li><code>maxval::Real=1e5</code> if no <code>MultistartDomain</code> is specified, a cube of size <code>(-maxval, maxval)^(×n)</code> is constructed</li></ul><p>This returns a <code>MultistartResults</code> object, which saves some additional information such as the number of iterations taken per run, the initial guesses, etc. The parameter configuration is obtained with <code>MLE(R)</code>. Alternatively, one could for example specify a distribution for the initials of the multistart optimization via</p><pre><code class="language-julia hljs">MultistartFit(DM, MvNormal([0,0], Diagonal(ones(2))); MultistartDomain=HyperCube([-1,-1],[3,4]), N=200, meth=Newton())</code></pre><p>The results of a multistart optimization can be visualized with a plot of the sorted final objective values, ideally showing prominent step-like features where the optimization reliably converged to the same local optima multiple times.</p><pre><code class="language-julia hljs">WaterfallPlot(R; BiLog=true)</code></pre><img src="b8b68a96.svg" alt="Example block output"/><p>It can also be useful to investigate whether the parameter configurations within one &quot;step&quot; of the plot, where the final objective function value was the same, are actually &quot;close&quot; to each other, or whether there are distinct (or spread out) local optima, which nevertheless produce a fit of the same quality. This can be plotted via the <code>ParameterPlot</code> method, which can display the data either in a <code>:dotplot</code>, <code>:boxplot</code> or <code>:violin</code> plot. </p><pre><code class="language-julia hljs">using StatsPlots
ParameterPlot(R; st=:dotplot)</code></pre><img src="bd63c217.svg" alt="Example block output"/><p>Seeing a spread in the <code>ParameterPlot</code> for the parameter configurations of the lowest &quot;step&quot; is already an indication that some parameter may be non-identifiable.</p><p>Exemplary parameter configurations from the <code>n</code>-th step in a Waterfall plot can be conviently retrieved via <code>GetStepParameters(R, n)</code> for plotting and other analyses. For instance, to compare the fit corresponding to the local optimum constituted by the second step:</p><pre><code class="language-julia hljs">plot(DM, GetStepParameters(R, 2))</code></pre><img src="dc5f4d92.svg" alt="Example block output"/><article><details class="docstring" open="true"><summary id="InformationGeometry.minimize"><a class="docstring-binding" href="#InformationGeometry.minimize"><code>InformationGeometry.minimize</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">minimize(F::Function, start::AbstractVector{&lt;:Number}; tol::Real=1e-10, meth=NelderMead(), Full::Bool=false, maxtime::Real=600, kwargs...) -&gt; Vector
minimize(F, dF, start::AbstractVector{&lt;:Number}; tol::Real=1e-10, meth=LBFGS(;linesearch=LineSearches.BackTracking()), Full::Bool=false, maxtime::Real=600, kwargs...) -&gt; Vector
minimize(F, dF, ddF, start::AbstractVector{&lt;:Number}; tol::Real=1e-10, meth=NewtonTrustRegion(), Full::Bool=false, maxtime::Real=600, kwargs...) -&gt; Vector</code></pre><p>Minimizes the scalar input function using the given <code>start</code> using any algorithms from the <code>Optimation.jl</code> ecosystem specified via the keyword <code>meth</code>. <code>Full=true</code> returns the full solution object instead of only the minimizing result. Optionally, the search domain can be bounded by passing a suitable <code>HyperCube</code> object as the third argument (ignoring derivatives).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RafaelArutjunjan/InformationGeometry.jl/blob/7f6b482a61a242d5414e9fa9bd50bdc23fb47ec7/src/NumericalTools/Optimization.jl#L152-L159">source</a></section></details></article><article><details class="docstring" open="true"><summary id="InformationGeometry.MultistartFit"><a class="docstring-binding" href="#InformationGeometry.MultistartFit"><code>InformationGeometry.MultistartFit</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">MultistartFit(DM::AbstractDataModel; maxval::Real=1e5, MultistartDomain::HyperCube=FullDomain(pdim(DM), maxval), kwargs...)</code></pre><p>Performs Multistart optimization with <code>N</code> starts and timeout of fits after <code>timeout</code> seconds. If <code>resampling=true</code>, if likelihood non-finite new initial starts are redrawn until <code>N</code> suitable initials are found.  If <code>Robust=true</code>, performs optimization wrt. p-norm according to given kwarg <code>p</code>. For <code>Full=false</code>, only the final MLE is returned, otherwise a <code>MultistartResults</code> object is returned, which can be further analyzed and plotted. The keyword <code>TransformSample</code> can be used to specify a function which is applied to the sample, allowing e.g. for sampling only a subset of the parameters and then adding on components which should stay at fixed initial values for the multistart.</p><div class="admonition is-info" id="Note-3e64bee151d49fa2"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-3e64bee151d49fa2" title="Permalink"></a></header><div class="admonition-body"><p>Any further keyword arguments are passed through to the optimization procedure <a href="#InformationGeometry.minimize"><code>InformationGeometry.minimize</code></a> such as tolerances, optimization methods, domain constraints, etc.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RafaelArutjunjan/InformationGeometry.jl/blob/7f6b482a61a242d5414e9fa9bd50bdc23fb47ec7/src/NumericalTools/Multistart.jl#L64-L73">source</a></section></details></article><article><details class="docstring" open="true"><summary id="InformationGeometry.LocalMultistartFit"><a class="docstring-binding" href="#InformationGeometry.LocalMultistartFit"><code>InformationGeometry.LocalMultistartFit</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">LocalMultistartFit(DM::AbstractDataModel, scale::Real=sqrt(InvChisqCDF(DOF(DM), ConfVol(2.0))); kwargs...)
LocalMultistartFit(DM::AbstractDataModel, mle::AbstractVector{&lt;:Number}, scale::Real=sqrt(InvChisqCDF(DOF(DM), ConfVol(2.0))); kwargs...)</code></pre><p>Performs a multistart search locally around a given MLE in a cube constructed from the Fisher information and multiplied with <code>scale</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RafaelArutjunjan/InformationGeometry.jl/blob/7f6b482a61a242d5414e9fa9bd50bdc23fb47ec7/src/NumericalTools/Multistart.jl#L149-L153">source</a></section></details></article><article><details class="docstring" open="true"><summary id="InformationGeometry.WaterfallPlot"><a class="docstring-binding" href="#InformationGeometry.WaterfallPlot"><code>InformationGeometry.WaterfallPlot</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">WaterfallPlot(R::MultistartResults; BiLog::Bool=true, MaxValue::Real=3000, StepTol::Real=1e-3, kwargs...)</code></pre><p>Shows Waterfall plot for the given results of MultistartFit. <code>StepTol</code> is used to decide which difference of two neighbouring values in the Waterfall plot constitutes a step. <code>StepTol=0</code> deactivates step marks. <code>MaxValue</code> is used to set threshold for ignoring points whose cost function after optimization is too large compared with best optimum. <code>BiLog=false</code> disables logarithmic scale for cost function. A custom transformation can be specified via keyword <code>Trafo::Function</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RafaelArutjunjan/InformationGeometry.jl/blob/7f6b482a61a242d5414e9fa9bd50bdc23fb47ec7/src/NumericalTools/Multistart.jl#L278-L284">source</a></section></details></article><article><details class="docstring" open="true"><summary id="InformationGeometry.ParameterPlot-Tuple{MultistartResults}"><a class="docstring-binding" href="#InformationGeometry.ParameterPlot-Tuple{MultistartResults}"><code>InformationGeometry.ParameterPlot</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">ParameterPlot(R::MultistartResults; st=:dotplot, BiLog::Bool=true, Nsteps::Int=5, StepTol::Real=1e-3, MaxValue=3000)</code></pre><p>Plots the parameter values of the <code>MultistartResults</code> separated by step to show whether the different optima are localized or not. <code>st</code> can be either <code>:dotplot</code>, <code>:boxplot</code> or <code>:violin</code>.</p><div class="admonition is-info" id="Note-fde149e674803965"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-fde149e674803965" title="Permalink"></a></header><div class="admonition-body"><p>StatsPlots.jl needs to be loaded to use this plotting function.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RafaelArutjunjan/InformationGeometry.jl/blob/7f6b482a61a242d5414e9fa9bd50bdc23fb47ec7/src/NumericalTools/Multistart.jl#L287-L293">source</a></section></details></article><article><details class="docstring" open="true"><summary id="InformationGeometry.IncrementalTimeSeriesFit-Tuple{DataModel}"><a class="docstring-binding" href="#InformationGeometry.IncrementalTimeSeriesFit-Tuple{DataModel}"><code>InformationGeometry.IncrementalTimeSeriesFit</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">IncrementalTimeSeriesFit(DM::AbstractDataModel, initial::AbstractVector{&lt;:Number}=MLE(DM); steps::Int=length(Data(DM))÷5, Method::Function=InformationGeometry.minimize, kwargs...) -&gt; Vector</code></pre><p>Fits DataModel incrementally by splitting up the times series into chunks, e.g. fitting only the first quarter of data points, then half and so on. This can yield much better fitting results from random starting points, particularly for autocorrelated time series data. For example when the time series data oscillates in such a way that the optimization often gets stuck in a local optimum where the model fits a mostly straight line through the data, not correctly recognizing the oscillations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RafaelArutjunjan/InformationGeometry.jl/blob/7f6b482a61a242d5414e9fa9bd50bdc23fb47ec7/src/NumericalTools/Optimization.jl#L410-L415">source</a></section></details></article><article><details class="docstring" open="true"><summary id="InformationGeometry.RobustFit"><a class="docstring-binding" href="#InformationGeometry.RobustFit"><code>InformationGeometry.RobustFit</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">RobustFit(DM::AbstractDataModel, start::AbstractVector{&lt;:Number}; tol::Real=1e-10, p::Real=1, kwargs...)</code></pre><p>Uses <code>p</code>-Norm to judge distance on Dataspace as specified by the keyword.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RafaelArutjunjan/InformationGeometry.jl/blob/7f6b482a61a242d5414e9fa9bd50bdc23fb47ec7/src/NumericalTools/Optimization.jl#L388-L391">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../datamodels/">« Providing Data and Models</a><a class="docs-footer-nextpage" href="../confidence-regions/">Confidence Regions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 26 November 2025 12:52">Wednesday 26 November 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
