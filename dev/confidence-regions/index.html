<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Confidence Regions · InformationGeometry</title><meta name="title" content="Confidence Regions · InformationGeometry"/><meta property="og:title" content="Confidence Regions · InformationGeometry"/><meta property="twitter:title" content="Confidence Regions · InformationGeometry"/><meta name="description" content="Documentation for InformationGeometry."/><meta property="og:description" content="Documentation for InformationGeometry."/><meta property="twitter:description" content="Documentation for InformationGeometry."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="InformationGeometry logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">InformationGeometry</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Getting Started</a></li><li><a class="tocitem" href="../basics/">Basics of Information Geometry</a></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="../datamodels/">Providing Data and Models</a></li><li class="is-active"><a class="tocitem" href>Confidence Regions</a></li><li><a class="tocitem" href="../transformations/">Model Transformations</a></li><li><a class="tocitem" href="../parallelization/">Parallelization</a></li><li><a class="tocitem" href="../exporting/">Exporting</a></li></ul></li><li><span class="tocitem">Advanced Examples</span><ul><li><a class="tocitem" href="../ODEmodels/">ODE-based models</a></li><li><a class="tocitem" href="../AdvancedData/">Advanced Datasets</a></li></ul></li><li><a class="tocitem" href="../methodlist/">List of useful methods</a></li><li><a class="tocitem" href="../todo/">Contributing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorial</a></li><li class="is-active"><a href>Confidence Regions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Confidence Regions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/RafaelArutjunjan/InformationGeometry.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/RafaelArutjunjan/InformationGeometry.jl/blob/master/docs/src/confidence-regions.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h3 id="Confidence-Regions"><a class="docs-heading-anchor" href="#Confidence-Regions">Confidence Regions</a><a id="Confidence-Regions-1"></a><a class="docs-heading-anchor-permalink" href="#Confidence-Regions" title="Permalink"></a></h3><p>One of the primary goals of <a href="https://github.com/RafaelArutjunjan/InformationGeometry.jl"><strong>InformationGeometry.jl</strong></a> is to enable the user to investigate the relationships between different parameters in a model in detail by determining and visualizing the <strong>exact</strong> confidence regions associated with the best fit parameters. In this context, <em>exact</em> refers to the fact that no simplifying assumptions are made about the shape of the confidence regions.</p><pre><code class="language-julia hljs">using InformationGeometry, Plots
DS = DataSet([1,2,3,4], [4,5,6.5,9], [0.5,0.45,0.6,1])
model(x::Real, θ::AbstractVector{&lt;:Real}) = θ[1] * x + θ[2]
DM = DataModel(DS, model)
plot(DM)</code></pre><p><img src="https://raw.githubusercontent.com/RafaelArutjunjan/InformationGeometry.jl/master/docs/assets/CR-FittedPlot.svg" alt/></p><p>Depending on how the parameters <span>$\theta$</span> enter into the model, the shapes of confidence regions associated with the model may be distorted. For the linearly parametrized model <span>$y_\text{model}(x;\theta) = \theta_1 \cdot x + \theta_2$</span> from above, the <span>$1 \sigma$</span> and <span>$2 \sigma$</span> confidence regions form perfect ellipses around the maximum likelihood estimate as expected:</p><pre><code class="language-julia hljs">sols = ConfidenceRegions(DM, 1:2; tol=1e-9)
VisualizeSols(DM, sols)</code></pre><p><img src="https://raw.githubusercontent.com/RafaelArutjunjan/InformationGeometry.jl/master/docs/assets/sols.svg" alt/></p><p>For a non-linearly parametrized model such as <span>$y_\text{model}(x;\theta) = {\theta_1}^{\!3} \cdot x + \mathrm{exp}(\theta_1 + \theta_2)$</span> (which also produces a straight line fit!), the confidence regions are no longer ellipsoidal:</p><pre><code class="language-julia hljs">model2(x::Real, θ::AbstractVector{&lt;:Real}) = θ[1]^3 * x + exp(θ[1] + θ[2])
DM2 = DataModel(DS, model2)
sols2 = ConfidenceRegions(DM2, 1:2; tol=1e-9)
VisualizeSols(DM2, sols2)</code></pre><p><img src="https://raw.githubusercontent.com/RafaelArutjunjan/InformationGeometry.jl/master/docs/assets/sols2.svg" alt/></p><p>Specifically in the case of two-dimensional parameter spaces as shown here, the problem of finding the exact boundaries of the confidence regions is turned into a system of ordinary differential equations and subsequently solved using the <a href="https://github.com/SciML/DifferentialEquations.jl"><strong>DifferentialEquations.jl</strong></a> suite. As a result, the boundaries of the confidence regions are obtained in the form of <code>ODESolution</code> objects, which come equipped with elaborate interpolation methods.</p><p>Both finding as well as visualizing exact confidence regions for models depending on more than two parameters (i.e. <span>$\mathrm{dim} \, \mathcal{M} &gt; 2$</span>) is more challenging from a technical perspective. For such models, it is clearly only possible to visualize three-dimensional slices of the parameter space at a time. The easiest way to achieve this is to intersect the confidence region with a family of 2D planes, in which the boundaries of the confidence region are computed using the 2D scheme.</p><p>The specific components of <span>$\theta$</span> to be visualized can be passed as a tuple to <code>ConfidenceRegion()</code> via the keyword argument <code>Dirs=(1,2,3)</code>. Also, the keyword <code>N</code> can be used to (approximately) control the number of planes with which the confidence region of interest is intersected.</p><pre><code class="language-julia hljs">DM3 = DataModel(DS, (x,θ)-&gt; θ[1]^3 * x + exp(θ[1] + θ[2]) + θ[3] * sin(x))
Planes, sols3 = ConfidenceRegion(DM3, 1; tol=1e-6, Dirs=(1,2,3), N=50)
VisualizeSols(DM3, Planes, sols3)</code></pre><p><img src="https://raw.githubusercontent.com/RafaelArutjunjan/InformationGeometry.jl/master/docs/assets/sols3.svg" alt/></p><p>Here, only the <span>$1\sigma$</span> confidence region is shown. Given the non-linearity of the model, it is of course no surprise that the region is strongly distorted compared with a perfect ellipsoid.</p><p>Once the boundary of a confidence region associated with some particular level has been computed, it can be used to establish the most extreme deviations from the maximum likelihood prediction, which are possible at said confidence level. These can then be illustrated as so-called &quot;pointwise confidence bands&quot; around the best fit. For example, given the confidence boundaries of the model <code>DM2</code> from above, the <span>$2\sigma$</span> confidence band can be obtained via:</p><pre><code class="language-julia hljs">plot(DM2)
ConfidenceBands(DM2, sols2[2])</code></pre><p><img src="https://raw.githubusercontent.com/RafaelArutjunjan/InformationGeometry.jl/master/docs/assets/Bands.svg" alt/></p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="InformationGeometry.ConfidenceRegions-Tuple{DataModel, Vector{Float64}}" href="#InformationGeometry.ConfidenceRegions-Tuple{DataModel, Vector{Float64}}"><code>InformationGeometry.ConfidenceRegions</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ConfidenceRegions(DM::DataModel, Range::AbstractVector)</code></pre><p>Computes the boundaries of confidence regions for two-dimensional parameter spaces given a vector or range of confidence levels. A convenient interface which extends this to higher dimensions is currently still under development.</p><p>For example,</p><pre><code class="language-julia hljs">ConfidenceRegions(DM, 1:3; tol=1e-9)</code></pre><p>computes the <span>$1\sigma$</span>, <span>$2\sigma$</span> and <span>$3\sigma$</span> confidence regions associated with a given <code>DataModel</code> using a solver tolerance of <span>$10^{-9}$</span>.</p><p>Keyword arguments:</p><ul><li><code>IsConfVol = true</code> can be used to specify the desired confidence level directly in terms of a probability <span>$p \in [0,1]$</span> instead of in units of standard deviations <span>$\sigma$</span>,</li><li><code>tol</code> can be used to quantify the tolerance with which the ODE which defines the confidence boundary is solved (default <code>tol = 1e-9</code>),</li><li><code>meth</code> can be used to specify the solver algorithm (default <code>meth = Tsit5()</code>),</li><li><code>ADmode=Val(false)</code> computes the Score by separately evaluating the <code>model</code> as well as the Jacobian <code>dmodel</code> provided in <code>DM</code>. Other choices of <code>ADmode</code> directly compute the Score by differentiating the formula the log-likelihood, i.e. only one evaluation on a dual variable is performed.</li><li><code>parallel = true</code> parallelizes the computations of the separate confidence regions provided each process has access to the necessary objects,</li><li><code>dof</code> can be used to manually specify the degrees of freedom.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RafaelArutjunjan/InformationGeometry.jl/blob/0ab477f1c320c504d67ca8c21fb8d2b64e06087c/src/ConfidenceRegions.jl#L526-L544">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="InformationGeometry.ConfidenceBands" href="#InformationGeometry.ConfidenceBands"><code>InformationGeometry.ConfidenceBands</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ConfidenceBands(DM::DataModel, sol::AbstractODESolution, Xdomain::HyperCube; N::Int=300, plot::Bool=true) -&gt; Matrix</code></pre><p>Given a confidence interval <code>sol</code>, the pointwise confidence band around the model prediction is computed for x values in <code>Xdomain</code> by evaluating the model on the boundary of the confidence region.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RafaelArutjunjan/InformationGeometry.jl/blob/0ab477f1c320c504d67ca8c21fb8d2b64e06087c/src/Plotting.jl#L745-L749">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../datamodels/">« Providing Data and Models</a><a class="docs-footer-nextpage" href="../transformations/">Model Transformations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Monday 11 November 2024 15:50">Monday 11 November 2024</span>. Using Julia version 1.10.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
