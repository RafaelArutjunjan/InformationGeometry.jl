<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Confidence Regions · InformationGeometry</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">InformationGeometry</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Getting Started</a></li><li><a class="tocitem" href="../basics/">Basics of Information Geometry</a></li><li><span class="tocitem">Tutorials</span><ul><li class="is-active"><a class="tocitem" href>Confidence Regions</a></li><li><a class="tocitem" href="../kullback-leibler/">Kullback-Leibler Divergences</a></li></ul></li><li><a class="tocitem" href="../todo/">Contributing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Confidence Regions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Confidence Regions</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/RafaelArutjunjan/InformationGeometry.jl/blob/master/docs/src/confidence-regions.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h3 id="Confidence-Regions"><a class="docs-heading-anchor" href="#Confidence-Regions">Confidence Regions</a><a id="Confidence-Regions-1"></a><a class="docs-heading-anchor-permalink" href="#Confidence-Regions" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="InformationGeometry.DataSet" href="#InformationGeometry.DataSet"><code>InformationGeometry.DataSet</code></a> — <span class="docstring-category">Type</span></header><section><div><p>The <code>DataSet</code> type is a container for data points. It holds 3 vectors <code>x</code>, <code>y</code>, <code>sigma</code> where the components of <code>sigma</code> quantify the standard deviation associated with each measurement. For example,</p><pre><code class="language-julia">DS = DataSet([1,2,3.],[4,5,6.5],[0.5,0.45,0.6])</code></pre><p>Its fields can be obtained via <code>xdata(DS)</code>, <code>ydata(DS)</code>, <code>sigma(DS)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RafaelArutjunjan/InformationGeometry.jl/blob/dd3de954a97f6d79374878be789b6e0e8f94dd77/src/Structures.jl#L6-L13">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InformationGeometry.DataModel" href="#InformationGeometry.DataModel"><code>InformationGeometry.DataModel</code></a> — <span class="docstring-category">Type</span></header><section><div><p>In addition to a <code>DataSet</code>, a <code>DataModel</code> contains the model as a function <code>model(x,θ)</code> and its derivative <code>dmodel(x,θ)</code> where <code>x</code> denotes the x-value of the data and <code>θ</code> is a vector of parameters on which the model depends. Crucially, <code>dmodel</code> contains the derivatives of the model with respect to the parameters <code>θ</code>, not the x-values. For example</p><pre><code class="language-julia">DS = DataSet([1,2,3.],[4,5,6.5],[0.5,0.45,0.6])
model(x,p::Vector) = p[1] .* x .+ p[2]
DM = DataModel(DS,model)</code></pre><p>If provided like this, the gradient of the model with respect to the parameters <code>p</code> (i.e. its &quot;Jacobian&quot;) will be calculated using automatic differentiation. Alternatively, an explicit analytic expression for the Jacobian can be specified by hand:</p><pre><code class="language-julia">function dmodel(x,p::Vector)
   J = Array{Float64}(undef, length(x), length(p))
   @. J[:,1] = x        # ∂(model)/∂p₁
   @. J[:,2] = 1.       # ∂(model)/∂p₂
   return J
end
DM = DataModel(DS,model,dmodel)</code></pre><p>The output of the Jacobian must be a matrix whose columns correspond to the partial derivatives with respect to different components of <code>p</code> and whose rows correspond to evaluations at different values of <code>x</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RafaelArutjunjan/InformationGeometry.jl/blob/dd3de954a97f6d79374878be789b6e0e8f94dd77/src/Structures.jl#L42-L61">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="StatsBase.loglikelihood-Tuple{DataModel,Array{Float64,1}}" href="#StatsBase.loglikelihood-Tuple{DataModel,Array{Float64,1}}"><code>StatsBase.loglikelihood</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">loglikelihood(DM::DataModel, θ::Vector)</code></pre><p>Calculates the logarithm of the likelihood <span>$\ell(\mathrm{data} \, | \, \theta) \coloneqq \mathrm{ln} \big( L(\mathrm{data} \, | \, \theta) \big)$</span> given a <code>DataModel</code> and a parameter configuration <span>$\theta$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RafaelArutjunjan/InformationGeometry.jl/blob/dd3de954a97f6d79374878be789b6e0e8f94dd77/src/ConfidenceLib.jl#L11-L14">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InformationGeometry.FindMLE-Tuple{DataModel}" href="#InformationGeometry.FindMLE-Tuple{DataModel}"><code>InformationGeometry.FindMLE</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">FindMLE(DM::DataModel,start::Union{Bool,Vector}=false; Big::Bool=false, max::Int=50) -&gt; Vector</code></pre><p>Finds the maximum likelihood parameter configuration given a <code>DataModel</code> and optionally a starting configuration. <code>Big=true</code> will return the value as a <code>BigFloat</code>. If no starting value is provided (i.e. <code>start=false</code>) the dimension of the parameter space is inferred automatically and the initial configuration is chosen as <code>start=ones(dim)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RafaelArutjunjan/InformationGeometry.jl/blob/dd3de954a97f6d79374878be789b6e0e8f94dd77/src/ConfidenceLib.jl#L432-L436">source</a></section></article><pre><code class="language-julia">DS = DataSet([1,2,3.],[4,5,6.5],[0.5,0.45,0.6])
model(x,θ) = θ[1] .* x .+ θ[2]
DM = DataModel(DS,model)
MLE = FindMLE(DM)</code></pre><pre class="documenter-example-output">2-element Array{Float64,1}:
 1.2306338028169015
 2.681338028169014 </pre><p>Depending on how the parameters <span>$\theta$</span> enter into the model, the shapes of confidence regions associated with the model may be distorted. For the linearly parametrized model shown above, the <span>$1 \sigma$</span> and <span>$2 \sigma$</span> confidence regions form perfect hyperellipses as expected:</p><pre><code class="language-julia">sols = GenerateMultipleIntervals(DM,1:2)
VisualizeSols(sols)</code></pre><pre class="documenter-example-output"> 22.078068 seconds (59.00 M allocations: 2.955 GiB, 7.57% gc time)
  0.104104 seconds (1.43 M allocations: 42.022 MiB)</pre><p><img src="https://raw.githubusercontent.com/RafaelArutjunjan/InformationGeometry.jl/master/docs/assets/sols.svg" alt/></p><p>For a non-linearly parametrized model, the confidence regions are found to be non-ellipsoidal:</p><pre><code class="language-julia">model2(x,θ) = θ[1]^3 .* x .+ exp(θ[1] + θ[2])
DM2 = DataModel(DS,model2)
sols2 = GenerateMultipleIntervals(DM2,1:2)
VisualizeSols(sols2)</code></pre><pre class="documenter-example-output">  0.318805 seconds (1.60 M allocations: 56.308 MiB, 11.99% gc time)
  0.101445 seconds (1.36 M allocations: 39.973 MiB)</pre><p><img src="https://raw.githubusercontent.com/RafaelArutjunjan/InformationGeometry.jl/master/docs/assets/sols2.svg" alt/></p><p>Since both finding and visualizing exact confidence regions for models depending on more than two parameters (i.e. <span>$\mathrm{dim} \, \mathcal{M} &gt; 2$</span>) is more challenging from a technical perspective, the above methods only work for <span>$\mathrm{dim} \, \mathcal{M} = 2$</span> at this point in time. However, methods which allow for visualizations of confidence regions in arbitrary three-dimensional subspaces of parameter manifolds of any dimension are close to being finished and will follow soon.</p><p>Various geometric quantities which are intrinsic to the parameter manifold <span>$\mathcal{M}$</span> can be computed as a result of the Fisher metric <span>$g$</span> (and subsequent choice of the Levi-Civita connection) such as the Riemann and Ricci tensors and the Ricci scalar <span>$R$</span>.</p><article class="docstring"><header><a class="docstring-binding" id="InformationGeometry.FisherMetric-Tuple{DataModel,Array{Float64,1}}" href="#InformationGeometry.FisherMetric-Tuple{DataModel,Array{Float64,1}}"><code>InformationGeometry.FisherMetric</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">FisherMetric(DM::DataModel, θ::Vector{&lt;:Real})</code></pre><p>Computes the Fisher metric <span>$g$</span> given a <code>DataModel</code> and a parameter configuration <span>$\theta$</span> under the assumption that the likelihood <span>$L(\mathrm{data} \, | \, \theta)$</span> is a multivariate normal distribution.</p><div>\[g_{ab}(\theta) \coloneqq -\int_{\mathcal{D}} \mathrm{d}^m y_{\mathrm{data}} \, L(y_{\mathrm{data}} \,|\, \theta) \, \frac{\partial^2 \, \mathrm{ln}(L)}{\partial \theta^a \, \partial \theta^b} = -\mathbb{E} \bigg( \frac{\partial^2 \, \mathrm{ln}(L)}{\partial \theta^a \, \partial \theta^b} \bigg)\]</div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RafaelArutjunjan/InformationGeometry.jl/blob/dd3de954a97f6d79374878be789b6e0e8f94dd77/src/ConfidenceLib.jl#L663-L669">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InformationGeometry.GeometricDensity-Tuple{DataModel,Array{Float64,1}}" href="#InformationGeometry.GeometricDensity-Tuple{DataModel,Array{Float64,1}}"><code>InformationGeometry.GeometricDensity</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">GeometricDensity(DM::DataModel, θ::Vector)</code></pre><p>Computes the square root of the determinant of the Fisher metric <span>$\sqrt{\mathrm{det}\big(g(\theta)\big)}$</span> at the point <span>$\theta$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RafaelArutjunjan/InformationGeometry.jl/blob/dd3de954a97f6d79374878be789b6e0e8f94dd77/src/Geodesics.jl#L524-L527">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InformationGeometry.ChristoffelSymbol-Tuple{DataModel,Array{Float64,1}}" href="#InformationGeometry.ChristoffelSymbol-Tuple{DataModel,Array{Float64,1}}"><code>InformationGeometry.ChristoffelSymbol</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">ChristoffelSymbol(DM::DataModel, θ::Vector; BigCalc::Bool=false)
ChristoffelSymbol(Metric::Function, θ::Vector; BigCalc::Bool=false)</code></pre><p>Calculates the components of the (1,2) Christoffel symbol <span>$\Gamma$</span> at a point <span>$\theta$</span> (i.e. the Christoffel symbol &quot;of the second kind&quot;) through finite differencing of the <code>Metric</code>. Accurate to ≈ 3e-11. <code>BigCalc=true</code> increases accuracy through BigFloat calculation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RafaelArutjunjan/InformationGeometry.jl/blob/dd3de954a97f6d79374878be789b6e0e8f94dd77/src/Geodesics.jl#L68-L73">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InformationGeometry.Riemann-Tuple{DataModel,Array{Float64,1}}" href="#InformationGeometry.Riemann-Tuple{DataModel,Array{Float64,1}}"><code>InformationGeometry.Riemann</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">Riemann(DM::DataModel, θ::Vector; BigCalc::Bool=false)
Riemann(Metric::Function, θ::Vector; BigCalc::Bool=false)</code></pre><p>Calculates the components of the (1,3) Riemann tensor by finite differencing of the <code>Metric</code>. <code>BigCalc=true</code> increases accuracy through BigFloat calculation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RafaelArutjunjan/InformationGeometry.jl/blob/dd3de954a97f6d79374878be789b6e0e8f94dd77/src/Geodesics.jl#L475-L479">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InformationGeometry.Ricci-Tuple{DataModel,Array{Float64,1}}" href="#InformationGeometry.Ricci-Tuple{DataModel,Array{Float64,1}}"><code>InformationGeometry.Ricci</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">Ricci(DM::DataModel, θ::Vector; BigCalc::Bool=false)
Ricci(Metric::Function, θ::Vector; BigCalc::Bool=false)</code></pre><p>Calculates the components of the (0,2) Ricci tensor by finite differencing of <code>Metric</code>. <code>BigCalc=true</code> increases accuracy through BigFloat calculation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RafaelArutjunjan/InformationGeometry.jl/blob/dd3de954a97f6d79374878be789b6e0e8f94dd77/src/Geodesics.jl#L500-L504">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InformationGeometry.RicciScalar-Tuple{DataModel,Array{Float64,1}}" href="#InformationGeometry.RicciScalar-Tuple{DataModel,Array{Float64,1}}"><code>InformationGeometry.RicciScalar</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">RicciScalar(DM::DataModel, θ::Vector; BigCalc::Bool=false)
RicciScalar(Metric::Function, θ::Vector; BigCalc::Bool=false)</code></pre><p>Calculates the Ricci scalar by finite differencing of the <code>Metric</code>. <code>BigCalc=true</code> increases accuracy through <code>BigFloat</code> calculation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RafaelArutjunjan/InformationGeometry.jl/blob/dd3de954a97f6d79374878be789b6e0e8f94dd77/src/Geodesics.jl#L513-L517">source</a></section></article><p>Further, studying the geodesics / autoparallels on a manifold can yield enlightening insights about its geometry.</p><article class="docstring"><header><a class="docstring-binding" id="InformationGeometry.Score-Tuple{DataModel,Array{Float64,1}}" href="#InformationGeometry.Score-Tuple{DataModel,Array{Float64,1}}"><code>InformationGeometry.Score</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">Score(DM::DataModel, θ::Vector{&lt;:Real}; Auto::Bool=false)</code></pre><p>Calculates the gradient of the log-likelihood with respect to a set of parameters <code>p</code>. <code>Auto=true</code> uses automatic differentiation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RafaelArutjunjan/InformationGeometry.jl/blob/dd3de954a97f6d79374878be789b6e0e8f94dd77/src/ConfidenceLib.jl#L89-L92">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InformationGeometry.AIC-Tuple{DataModel,Array{Float64,1}}" href="#InformationGeometry.AIC-Tuple{DataModel,Array{Float64,1}}"><code>InformationGeometry.AIC</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">AIC(DM::DataModel, θ::Vector)</code></pre><p>Calculates the Akaike Information Criterion given a parameter configuration <span>$\theta$</span> defined by <span>$\mathrm{AIC} = -2 \, \ell(\mathrm{data} \, | \, \theta) + 2 \, \mathrm{length}(\theta)$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RafaelArutjunjan/InformationGeometry.jl/blob/dd3de954a97f6d79374878be789b6e0e8f94dd77/src/ConfidenceLib.jl#L830-L833">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InformationGeometry.GeodesicDistance-Tuple{DataModel,Array{Float64,1},Array{Float64,1}}" href="#InformationGeometry.GeodesicDistance-Tuple{DataModel,Array{Float64,1},Array{Float64,1}}"><code>InformationGeometry.GeodesicDistance</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">GeodesicDistance(DM::DataModel,P::Vector{&lt;:Real},Q::Vector{&lt;:Real}; tol::Real=1e-10)
GeodesicDistance(Metric::Function,P::Vector{&lt;:Real},Q::Vector{&lt;:Real}; tol::Real=1e-10)</code></pre><p>Computes the length of a geodesic connecting the points <code>P</code> and <code>Q</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/RafaelArutjunjan/InformationGeometry.jl/blob/dd3de954a97f6d79374878be789b6e0e8f94dd77/src/Geodesics.jl#L295-L299">source</a></section></article><p><strong>To be continued...</strong></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../basics/">« Basics of Information Geometry</a><a class="docs-footer-nextpage" href="../kullback-leibler/">Kullback-Leibler Divergences »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 7 October 2020 21:54">Wednesday 7 October 2020</span>. Using Julia version 1.3.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
