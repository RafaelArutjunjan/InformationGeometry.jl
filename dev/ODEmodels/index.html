<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>ODE-based models · InformationGeometry</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="InformationGeometry logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">InformationGeometry</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Getting Started</a></li><li><a class="tocitem" href="../basics/">Basics of Information Geometry</a></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="../datamodels/">Providing Data and Models</a></li><li><a class="tocitem" href="../confidence-regions/">Confidence Regions</a></li><li><a class="tocitem" href="../transformations/">Model Transformations</a></li><li><a class="tocitem" href="../parallelization/">Parallelization</a></li><li><a class="tocitem" href="../exporting/">Exporting</a></li><li><a class="tocitem" href="../kullback-leibler/">Kullback-Leibler Divergences</a></li></ul></li><li><span class="tocitem">Advanced Examples</span><ul><li class="is-active"><a class="tocitem" href>ODE-based models</a></li><li><a class="tocitem" href="../AdvancedData/">Advanced Datasets</a></li></ul></li><li><a class="tocitem" href="../methodlist/">List of useful methods</a></li><li><a class="tocitem" href="../todo/">Contributing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Advanced Examples</a></li><li class="is-active"><a href>ODE-based models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>ODE-based models</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/RafaelArutjunjan/InformationGeometry.jl/blob/master/docs/src/ODEmodels.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h3 id="ODE-based-models"><a class="docs-heading-anchor" href="#ODE-based-models">ODE-based models</a><a id="ODE-based-models-1"></a><a class="docs-heading-anchor-permalink" href="#ODE-based-models" title="Permalink"></a></h3><p>Often, an explicit analytical expression for a given mathematical model is not known. Instead, the model might be defined implicitly, e.g. as the solution to a system of ordinary differential equations. Especially in fields such as systems biology, modeling in terms of (various kinds of) differential equations appears to be the norm.</p><p>As a toy example, we will consider the well-known &quot;SIR model&quot; in the following, which groups a population into susceptible, infected and recovered subpopulations and assumes mass action kinetics with constant transmission and recovery rates to describe the growths and decays of the respective populations.</p><p>While the <a href="https://github.com/SciML/DifferentialEquations.jl"><strong>DifferentialEquations.jl</strong></a> ecosystem offers many different ways of specifying such systems, we will use the syntax introduced by <a href="https://github.com/SciML/ModelingToolkit.jl"><strong>ModelingToolkit.jl</strong></a> since it is particularly convenient in this case.</p><pre><code class="language-julia hljs">using InformationGeometry, ModelingToolkit, Plots
@parameters t β γ
@variables S(t) I(t) R(t)
Dt = Differential(t)

SIReqs = [ Dt(S) ~ -β * I * S,
        Dt(I) ~ +β * I * S - γ * I,
        Dt(R) ~ +γ * I]

SIRstates = [S, I, R];    SIRparams = [β, γ]
@named SIRsys = ODESystem(SIReqs, t, SIRstates, SIRparams)</code></pre><p>Here, the parameter <code>β</code> denotes the transmission rate of the disease and <code>γ</code> is the recovery rate. Note that in the symbolic scheme of <a href="https://github.com/SciML/ModelingToolkit.jl"><strong>ModelingToolkit.jl</strong></a>, the equal sign is represented via <code>~</code>.</p><p>An infection dataset which is well-known in the literature is taken from an influenza outbreak at a English boarding school in 1978. Its numerical values can be found e.g. in <a href="https://www.researchgate.net/publication/336701551_On_parameter_estimation_approaches_for_predicting_disease_transmission_through_optimization_deep_learning_and_statistical_inference_methods">table 1 of this paper</a>. As no uncertainties associated with the number of infections is given, we will assume the <span>$1\sigma$</span> uncertainties to be <span>$\pm 5$</span> as a reasonable value. Further, it is known that the total number of students at said boarding school was <span>$763$</span> and we will therefore assume the initial conditions to be</p><pre><code class="language-julia hljs">SIRinitial = [762, 1, 0.]</code></pre><p>for the respective susceptible, infected and recovered subpopulations on day zero. Next, the <code>DataSet</code> object is constructed as:</p><pre><code class="language-julia hljs">days = collect(1:14)
infected = [3, 8, 28, 75, 221, 291, 255, 235, 190, 126, 70, 28, 12, 5]
SIRDS = DataSet(days, infected, 5ones(14); xnames=[&quot;Days&quot;], ynames=[&quot;Infected&quot;])</code></pre><p>Finally, the <code>DataModel</code> associated with the SIR model and the given data is constructed by</p><pre><code class="language-julia hljs">SIRobservables = [2]
SIRDM = DataModel(SIRDS, SIRsys, SIRinitial, SIRobservables, [0.001, 0.1], tol=1e-11)</code></pre><p>where <code>SIRobservables</code> denotes the components of the <code>ODESystem</code> that have actually been observed in the given dataset (i.e. the second component which are the infected in this case). The optional vector <code>[0.001, 0.1]</code> is our initial guess for the parameters <code>[β, γ]</code> for the maximum likelihood estimation and the keyword <code>tol</code> specifies the desired accuracy of the ODE solver for all model predictions.</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>Instead of specifying the observable components of an ODE system as an array, it is also possible to provide an arbitrary observation function with argument signature <code>f(u)</code>, <code>f(u,t)</code> or <code>f(u,t,θ)</code>. Similarly, (parts of) the initial conditions for the ODE system can be included as parameters of the problem and estimated from data by providing a splitter function of the form <code>θ -&gt; (u0, p)</code>. The first entry of the returned tuple will be used as the initial condition for the ODE system and the second argument enters into the <code>ODEFunction</code> itself.</p><p>In this particular example, one might include the initial number of infections as a dynamical parameter via the splitter function <code>θ -&gt; ([763.0 - θ[1], θ[1], 0.0], θ[2:3])</code>.</p></div></div><p>It is now possible to compute properties of this <code>DataModel</code> such as confidence regions, confidence bands, geodesics, profile likelihoods, curvature tensors and so on as with any other model.</p><pre><code class="language-julia hljs">sols = ConfidenceRegions(SIRDM, 1:2)
VisualizeSols(SIRDM, sols)</code></pre><p><img src="https://raw.githubusercontent.com/RafaelArutjunjan/InformationGeometry.jl/master/docs/assets/SIRsols.svg" alt/></p><pre><code class="language-julia hljs">plot(SIRDM)
ConfidenceBands(SIRDM, sols[2])</code></pre><p><img src="https://raw.githubusercontent.com/RafaelArutjunjan/InformationGeometry.jl/master/docs/assets/SIRBands.svg" alt/></p><p>While it visually appears as though the confidence regions are perfectly ellipsoidal and the model would therefore be linearly dependent on its parameters <code>β</code> and <code>γ</code>, this is of course not the case. The non-linearity with respect to the parameters becomes much more apparent further away from the MLE, as one can confirm e.g. via radial geodesics emanating from the MLE or the profile likelihood.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../kullback-leibler/">« Kullback-Leibler Divergences</a><a class="docs-footer-nextpage" href="../AdvancedData/">Advanced Datasets »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Wednesday 6 July 2022 16:01">Wednesday 6 July 2022</span>. Using Julia version 1.6.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
